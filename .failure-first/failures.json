{
  "$schema": "https://failurespec.org/v1/schema.json",
  "version": "1.0",
  "metadata": {
    "feature": "Login page with username/password and OAuth for internal users (public-facing)",
    "created_by": "adversary-session-001",
    "frozen_at": "2026-02-05T00:00:00Z",
    "frozen_commit": null
  },
  "failures": [
    {
      "id": "F001",
      "title": "Brute force attack on password login",
      "severity": "critical",
      "oracle": {
        "condition": "After N failed attempts, further login attempts are blocked for a time period per IP and per account",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Login endpoint accessible"],
        "steps": ["Send 100 login requests with wrong password for same username in rapid succession"],
        "expected_if_vulnerable": "All 100 requests processed without blocking"
      },
      "evidence": {
        "type": "integration_test",
        "criteria": "Test sends N+1 requests, asserts blocking response after threshold"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Rate limiter with per-IP and per-account limits. 5 attempts per 15min window, then 15min block",
          "location": "src/lib/rate-limit.ts:1-100, src/app/api/auth/login/route.ts:25-50",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F002",
      "title": "Credential stuffing with known email/password pairs",
      "severity": "critical",
      "oracle": {
        "condition": "Distributed login attempts from multiple IPs are detected and throttled based on account-level patterns",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Login endpoint accessible", "List of known breached credentials"],
        "steps": ["Attempt login with 1000 different email/password pairs from rotating IPs"],
        "expected_if_vulnerable": "Successful logins for any valid credentials without detection"
      },
      "evidence": {
        "type": "log_analysis",
        "criteria": "Logs show anomaly detection triggered; accounts locked or CAPTCHA required"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Account-level rate limiting tracks failed attempts per email address, independent of IP. Locks account after 5 failed attempts per hour",
          "location": "src/lib/rate-limit.ts:20-30, src/app/api/auth/login/route.ts:51-65",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F003",
      "title": "Username enumeration via error messages",
      "severity": "medium",
      "oracle": {
        "condition": "Error message for invalid username is identical to error message for invalid password",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Login endpoint accessible"],
        "steps": [
          "Submit login with non-existent username",
          "Submit login with valid username but wrong password",
          "Compare response body, status code, and timing"
        ],
        "expected_if_vulnerable": "Different error messages or detectable timing difference"
      },
      "evidence": {
        "type": "manual_test",
        "criteria": "Both responses identical in content, status, and timing (within 50ms)"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Generic error constant GENERIC_AUTH_ERROR = 'Invalid email or password' used for all auth failures",
          "location": "src/lib/validation.ts:75-76, src/app/api/auth/login/route.ts:85",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F004",
      "title": "Username enumeration via timing side-channel",
      "severity": "medium",
      "oracle": {
        "condition": "Response time for valid vs invalid username differs by less than 50ms on average",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Login endpoint accessible", "One known valid username"],
        "steps": [
          "Send 100 requests with valid username + wrong password, measure avg response time",
          "Send 100 requests with invalid username, measure avg response time",
          "Compare averages"
        ],
        "expected_if_vulnerable": "Statistically significant timing difference (>50ms)"
      },
      "evidence": {
        "type": "timing_analysis",
        "criteria": "Statistical test shows no significant timing difference"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Delegated to Supabase Auth which uses constant-time comparison for password verification",
          "location": "Supabase infrastructure (external)",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F005",
      "title": "Password transmitted without TLS",
      "severity": "critical",
      "oracle": {
        "condition": "Login form only submits over HTTPS; HTTP requests are redirected or blocked",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Access to login page"],
        "steps": ["Attempt to submit login form over HTTP"],
        "expected_if_vulnerable": "Credentials transmitted in plaintext"
      },
      "evidence": {
        "type": "network_capture",
        "criteria": "HTTP POST to login endpoint fails or redirects; HSTS header present"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "HSTS header with 1-year max-age, includeSubDomains, preload. Middleware redirects HTTP to HTTPS in production",
          "location": "next.config.js:8-12, src/middleware.ts:12-18",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F006",
      "title": "Weak password accepted at registration/change",
      "severity": "high",
      "oracle": {
        "condition": "Passwords must meet minimum complexity: 12+ chars, mix of character types, not in common password list",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Registration or password change endpoint accessible"],
        "steps": ["Attempt to set password to 'password123'"],
        "expected_if_vulnerable": "Weak password accepted"
      },
      "evidence": {
        "type": "integration_test",
        "criteria": "Common weak passwords rejected with clear error message"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Zod schema requires 12+ chars, uppercase, lowercase, number, special char. Common password blocklist. Pattern detection for sequences/repeats",
          "location": "src/lib/validation.ts:5-50",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F007",
      "title": "Password logged in server logs or error messages",
      "severity": "critical",
      "oracle": {
        "condition": "Password field never appears in any log output, error messages, or stack traces",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Access to server logs", "Login endpoint accessible"],
        "steps": [
          "Submit login with unique password marker (e.g., 'MARKER_PASSWORD_TEST_12345')",
          "Search all log files for the marker"
        ],
        "expected_if_vulnerable": "Password marker found in logs"
      },
      "evidence": {
        "type": "log_search",
        "criteria": "grep/search returns no matches for password marker"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "SENSITIVE_FIELDS set includes password variants. sanitizeMetadata() redacts before logging. Double-check in logAuditEvent",
          "location": "src/lib/audit-log.ts:25-50",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F008",
      "title": "Session not invalidated on logout",
      "severity": "critical",
      "oracle": {
        "condition": "After logout, the previous session token returns 401 on protected endpoints",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Authenticated session"],
        "steps": [
          "Copy session token",
          "Logout via UI or API",
          "Use copied token to access protected endpoint"
        ],
        "expected_if_vulnerable": "Protected endpoint still accessible with old token"
      },
      "evidence": {
        "type": "integration_test",
        "criteria": "Request with old token returns 401"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Logout calls supabase.auth.signOut() which invalidates refresh token server-side. Cookies also deleted",
          "location": "src/app/api/auth/logout/route.ts:15-35",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F009",
      "title": "Session not invalidated on password change",
      "severity": "critical",
      "oracle": {
        "condition": "After password change, all other active sessions are invalidated",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["User logged in on two devices/sessions"],
        "steps": [
          "Change password on device A",
          "Attempt to access protected resource on device B with old session"
        ],
        "expected_if_vulnerable": "Device B session still valid"
      },
      "evidence": {
        "type": "integration_test",
        "criteria": "Device B receives 401 after password change on A"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Password change calls signOut({ scope: 'global' }) to invalidate ALL sessions including current one",
          "location": "src/app/api/auth/password/route.ts:55-60",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F010",
      "title": "Session token predictable or insufficiently random",
      "severity": "critical",
      "oracle": {
        "condition": "Session tokens are cryptographically random with at least 128 bits of entropy",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Ability to generate multiple session tokens"],
        "steps": [
          "Generate 1000 session tokens",
          "Analyze for patterns, sequential components, or insufficient entropy"
        ],
        "expected_if_vulnerable": "Predictable patterns or low entropy detected"
      },
      "evidence": {
        "type": "code_review",
        "criteria": "Token generation uses CSPRNG; tokens pass randomness tests"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Delegated to Supabase Auth which generates tokens using cryptographically secure random number generators",
          "location": "Supabase infrastructure (external)",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F011",
      "title": "Session token exposed in URL",
      "severity": "high",
      "oracle": {
        "condition": "Session tokens never appear in URLs; transmitted only via headers or secure cookies",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Authenticated session"],
        "steps": [
          "Navigate through application",
          "Check browser history and Referer headers for token leakage"
        ],
        "expected_if_vulnerable": "Token visible in URL or Referer headers"
      },
      "evidence": {
        "type": "traffic_analysis",
        "criteria": "No session tokens in URL paths or query parameters"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Tokens stored in HttpOnly cookies only. strict-origin-when-cross-origin referrer policy. No token parameters in URLs",
          "location": "next.config.js:22-25, src/lib/supabase/server.ts:15-25",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F012",
      "title": "Session cookie missing security flags",
      "severity": "high",
      "oracle": {
        "condition": "Session cookies have HttpOnly, Secure, and SameSite=Strict or Lax flags",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Authenticated session"],
        "steps": ["Inspect Set-Cookie header for session cookie"],
        "expected_if_vulnerable": "Missing HttpOnly, Secure, or SameSite flag"
      },
      "evidence": {
        "type": "header_inspection",
        "criteria": "All three flags present on session cookie"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Cookie options enforced in server.ts and middleware.ts: httpOnly=true, secure=true (prod), sameSite='lax'",
          "location": "src/lib/supabase/server.ts:20-27, src/middleware.ts:35-42",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F013",
      "title": "JWT signed with weak algorithm or secret",
      "severity": "critical",
      "oracle": {
        "condition": "JWTs use RS256/RS512 with proper key length, or HS256 with 256+ bit secret; 'none' algorithm rejected",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Ability to obtain a valid JWT"],
        "steps": [
          "Modify JWT header to use 'none' algorithm, submit to protected endpoint",
          "Attempt to crack HS256 secret with common wordlist"
        ],
        "expected_if_vulnerable": "'none' algorithm accepted or secret cracked"
      },
      "evidence": {
        "type": "security_test",
        "criteria": "Modified tokens rejected; secret not in common wordlists"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Delegated to Supabase Auth which uses HS256 with auto-generated 256+ bit secrets and rejects 'none' algorithm",
          "location": "Supabase infrastructure (external)",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F014",
      "title": "JWT/token has no expiration or excessive lifetime",
      "severity": "high",
      "oracle": {
        "condition": "Access tokens expire within 15-60 minutes; refresh tokens within 7-30 days",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Ability to obtain tokens"],
        "steps": [
          "Decode JWT and check exp claim",
          "Wait beyond expected expiry and test token"
        ],
        "expected_if_vulnerable": "No exp claim or token valid beyond acceptable lifetime"
      },
      "evidence": {
        "type": "token_inspection",
        "criteria": "exp claim present with appropriate lifetime"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Supabase project settings configure token lifetimes. Default: 1hr access, 1 week refresh. Configurable in dashboard",
          "location": "Supabase project settings (external)",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F015",
      "title": "Refresh token reuse after rotation",
      "severity": "critical",
      "oracle": {
        "condition": "Once a refresh token is used, it cannot be reused; reuse triggers session invalidation",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Valid refresh token"],
        "steps": [
          "Use refresh token to get new access token",
          "Attempt to use same refresh token again"
        ],
        "expected_if_vulnerable": "Second use succeeds instead of failing and invalidating session"
      },
      "evidence": {
        "type": "integration_test",
        "criteria": "Second use returns error; all tokens for session invalidated"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Supabase Auth handles refresh token rotation automatically. Reuse detection enabled by default",
          "location": "Supabase infrastructure (external)",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F016",
      "title": "OAuth state parameter missing or not validated",
      "severity": "critical",
      "oracle": {
        "condition": "OAuth flow requires and validates state parameter to prevent CSRF",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["OAuth login flow accessible"],
        "steps": [
          "Initiate OAuth flow, capture redirect URL",
          "Modify or remove state parameter",
          "Complete OAuth flow with modified state"
        ],
        "expected_if_vulnerable": "Login succeeds without valid state"
      },
      "evidence": {
        "type": "integration_test",
        "criteria": "Missing or invalid state parameter causes login failure"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Supabase Auth automatically generates and validates PKCE/state parameters for OAuth flows",
          "location": "Supabase infrastructure (external), src/app/login/page.tsx:55-65",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F017",
      "title": "OAuth redirect_uri not strictly validated",
      "severity": "critical",
      "oracle": {
        "condition": "OAuth redirect_uri must exactly match pre-registered URI; no partial matching or open redirect",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["OAuth login flow accessible"],
        "steps": [
          "Modify redirect_uri to attacker-controlled domain",
          "Attempt OAuth flow with modified redirect"
        ],
        "expected_if_vulnerable": "Authorization code or token sent to attacker domain"
      },
      "evidence": {
        "type": "security_test",
        "criteria": "Non-whitelisted redirect_uri rejected by OAuth provider"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "getAllowedRedirects() whitelist in callback route. isAllowedRedirect() performs exact match or valid relative path check",
          "location": "src/app/api/auth/callback/route.ts:10-30",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F018",
      "title": "OAuth token exchange vulnerable to code injection",
      "severity": "critical",
      "oracle": {
        "condition": "Authorization code can only be exchanged once; code is bound to client_id and redirect_uri",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Captured authorization code"],
        "steps": ["Attempt to exchange same authorization code twice"],
        "expected_if_vulnerable": "Second exchange succeeds"
      },
      "evidence": {
        "type": "integration_test",
        "criteria": "Second exchange fails with appropriate error"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Supabase Auth enforces single-use authorization codes. PKCE code_verifier binding prevents replay",
          "location": "Supabase infrastructure (external)",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F019",
      "title": "No MFA enforcement for privileged accounts",
      "severity": "critical",
      "oracle": {
        "condition": "All internal user accounts require MFA; login without MFA fails for covered accounts",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Internal user account without MFA configured"],
        "steps": ["Attempt to login with only username and password"],
        "expected_if_vulnerable": "Login succeeds without MFA challenge"
      },
      "evidence": {
        "type": "integration_test",
        "criteria": "Login blocked until MFA is configured and provided"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "REQUIRE_MFA env var enables enforcement. Login route checks for TOTP factors, requires enrollment or verification. Middleware checks AAL2 for protected routes",
          "location": "src/app/api/auth/login/route.ts:85-105, src/middleware.ts:55-70",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F020",
      "title": "MFA code can be reused",
      "severity": "high",
      "oracle": {
        "condition": "Each MFA code is single-use; replaying a code fails",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["MFA-enabled account", "Valid MFA code"],
        "steps": [
          "Complete login with MFA code",
          "Immediately attempt login again with same code"
        ],
        "expected_if_vulnerable": "Second login succeeds with reused code"
      },
      "evidence": {
        "type": "integration_test",
        "criteria": "Replayed code rejected"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Supabase MFA uses challenge/verify flow. Each challenge ID is single-use. TOTP codes have 30s window with replay protection",
          "location": "Supabase infrastructure (external), src/app/api/auth/mfa/route.ts:55-75",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F021",
      "title": "MFA brute force not rate-limited",
      "severity": "critical",
      "oracle": {
        "condition": "After N failed MFA attempts, account is locked or delay imposed",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Account at MFA challenge stage"],
        "steps": ["Submit 100 incorrect MFA codes in rapid succession"],
        "expected_if_vulnerable": "All attempts processed without lockout"
      },
      "evidence": {
        "type": "integration_test",
        "criteria": "Lockout triggered after threshold; attempts blocked"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Rate limiter with mfa:ip (3 per 5min) and mfa:account (5 per 10min) limits. 30min-1hr blocks on threshold",
          "location": "src/lib/rate-limit.ts:30-40, src/app/api/auth/mfa/route.ts:30-55",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F022",
      "title": "SQL injection in login form",
      "severity": "critical",
      "oracle": {
        "condition": "All user input parameterized; SQL injection payloads cause no database errors or bypass",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Login form accessible"],
        "steps": ["Submit username: ' OR '1'='1' -- and any password"],
        "expected_if_vulnerable": "Login succeeds or database error returned"
      },
      "evidence": {
        "type": "security_test",
        "criteria": "Injection payloads return generic auth failure; no SQL errors"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "Zod validation sanitizes input. Supabase Auth API uses parameterized queries internally. No raw SQL construction",
          "location": "src/lib/validation.ts:40-55, Supabase infrastructure (external)",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F023",
      "title": "XSS in login error messages",
      "severity": "high",
      "oracle": {
        "condition": "User-supplied input in error messages is properly escaped; script tags do not execute",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Login form accessible"],
        "steps": ["Submit username: <script>alert('xss')</script>", "Check if script executes in error message"],
        "expected_if_vulnerable": "JavaScript executes in browser"
      },
      "evidence": {
        "type": "security_test",
        "criteria": "Input escaped in HTML; no script execution"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "React auto-escapes all content in JSX. Server returns generic error messages, never echoes user input. sanitizeForDisplay() helper available",
          "location": "src/app/login/page.tsx (React), src/lib/validation.ts:78-85",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F024",
      "title": "CSRF on login form",
      "severity": "medium",
      "oracle": {
        "condition": "Login form requires valid CSRF token; cross-origin form submission fails",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Login form accessible"],
        "steps": [
          "Create HTML page on different origin with form posting to login endpoint",
          "Submit form from attacker page"
        ],
        "expected_if_vulnerable": "Login request processed from cross-origin"
      },
      "evidence": {
        "type": "security_test",
        "criteria": "Cross-origin login attempt rejected"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "SameSite=Lax cookies prevent cross-origin cookie submission. Login uses JSON POST which cannot be triggered by HTML forms (CORS blocks it)",
          "location": "src/lib/supabase/server.ts:25, src/app/login/page.tsx:35-45",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F025",
      "title": "Login audit log missing or incomplete",
      "severity": "high",
      "oracle": {
        "condition": "All login attempts (success/failure) logged with timestamp, IP, user agent, and username",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Access to audit logs"],
        "steps": [
          "Attempt successful login",
          "Attempt failed login",
          "Check logs for both events with required fields"
        ],
        "expected_if_vulnerable": "Events missing or incomplete metadata"
      },
      "evidence": {
        "type": "log_inspection",
        "criteria": "Both events present with all required fields"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "createAuditLogger() helper logs all events with timestamp, IP, userAgent, email, userId. Structured JSON output",
          "location": "src/lib/audit-log.ts:60-120, src/app/api/auth/login/route.ts:70-90",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    },
    {
      "id": "F026",
      "title": "Account lockout can be used for denial of service",
      "severity": "medium",
      "oracle": {
        "condition": "Account lockout is temporary (not permanent) and legitimate user has recovery path",
        "falsifiable": true
      },
      "repro": {
        "preconditions": ["Valid user account"],
        "steps": ["Trigger lockout via repeated failed attempts", "Attempt recovery as legitimate user"],
        "expected_if_vulnerable": "No recovery path or permanent lockout"
      },
      "evidence": {
        "type": "manual_test",
        "criteria": "Recovery path exists; lockout expires or can be cleared"
      },
      "status": {
        "state": "claimed",
        "guardrail": {
          "design": "All lockouts are temporary (15min-1hr). blockedUntil timestamp allows automatic recovery. retryAfter header informs user",
          "location": "src/lib/rate-limit.ts:15-25, 70-80",
          "implemented_by": "builder-session-001",
          "implemented_at": "2026-02-05T00:00:00Z"
        }
      }
    }
  ]
}
